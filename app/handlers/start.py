from aiogram import Router, F
from aiogram.filters import Command
from aiogram.types import Message, CallbackQuery
from fastapi import Depends
from sqlalchemy.orm import Session

from app.db import get_db
from app.db.utils import add_user
from app.keyboards.start import start_kb, start_instruction_kb, start_reply_keyboard_markup

router = Router()


def get_start_text() -> str:
    return ("üî•<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ simpleGmail –±–æ—Ç–∞</b>üî•\n\n –ß—Ç–æ —è —É–º–µ—é?\n\n"
            "‚úâ–í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–∏—Ö–æ–¥—è—â–∏–µ –≤–∞–º –Ω–∞ google –ø–æ—á—Ç—É\n\n"
            "‚öô–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã —Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ—Ç –Ω—É–∂–Ω—ã—Ö –ª—é–¥–µ–π\n\n"
            "ü§°–í–µ—Å–µ–ª–∏—Ç—å –≤–∞—Å –ª–æ–º–∞–Ω–æ–π HTMl —Ä–∞–∑–º–µ—Ç–∫–æ–π, –≤–µ–¥—å —Ç–µ–ª–µ–≥—Ä–∞–º - –æ–Ω —Ç–∞–∫–æ–π\n\n"
            "<b>–ß—Ç–æ –∂, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º! –í—Å–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é —Å–Ω–∏–∑—É –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ‚Üò</b>")


@router.message(Command('start'))
async def start(message: Message):
    user_id = message.from_user.id
    welcome_message = await add_user(user_id=user_id)

    await message.answer(welcome_message)
    await message.answer(get_start_text(), reply_markup=start_reply_keyboard_markup())


# @router.callback_query(F.data.startswith("start_back_to_main"))
# async def callbacks_start_main(callback: CallbackQuery):
#     await callback.message.edit_text(get_start_text(), reply_markup=start_kb())


@router.message(F.text.lower() == "üìÉ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è")
async def get_instruction(message: Message):
    await message.delete()
    await message.answer(text="üìÉ<b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</b>üìÉ\n\n"
                                           "–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –ø–æ—á—Ç—É, "
                                              "–≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ, "
                                              "–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à—É—é "
                                           "–Ω–∞—Å—Ç—Ä–æ–π–∫—É, –∞ –∏–º–µ–Ω–Ω–æ, —É–∑–Ω–∞—Ç—å –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç —Å–≤–æ–µ–π google –ø–æ—á—Ç—ã.\n\n"
                                           "1) –ó–∞—Ö–æ–¥–∏–º –Ω–∞ —Å–∞–π—Ç https://myaccount.google.com\n"
                                           "2) –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É '<i>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</i>' (–æ–Ω–∞ —Å–ª–µ–≤–∞, —Ä—è–¥–æ–º —Å –¥—Ä—É–≥–∏–º–∏ "
                                           "–≤–∫–ª–∞–¥–∫–∞–º–∏)\n"
                                           "3) –õ–∏—Å—Ç–∞–µ–º –¥–æ –±–ª–æ–∫–∞ '–í—Ö–æ–¥ –≤ Google' –∏ –Ω–∞–∂–∏–º–∞–µ–º –Ω–∞ '<i>–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è "
                                           "–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</i>'\n"
                                           "3.1) –ï—Å–ª–∏ –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ - –ø–æ–¥–∫–ª—é—á–∞–µ–º\n"
                                           "4) –õ–∏—Å—Ç–∞–µ–º –Ω–∞ –æ—Ç–∫—Ä—ã–≤—à–µ–π—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ —Å–∞–º—ã–π –Ω–∏–∑, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–º '–ü–∞—Ä–æ–ª–∏ "
                                           "–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π'\n"
                                           "5) –ù–∞–∂–∏–º–∞–µ–º –Ω–∞ —Å—Ç—Ä–µ–ª–æ—á–∫—É '<b>></b>' –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ("
                                           "–Ω–∞–∑–≤–∞–Ω–∏–µ "
                                           "–º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å –ª—é–±–æ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, 'Telegram')\n"
                                           "6) –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É '–°–æ–∑–¥–∞—Ç—å', –ø–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ —Å –≤–∞—à–∏–º –ø–∞—Ä–æ–ª–µ–º. "
                                           "–ö–æ–ø–∏—Ä—É–µ–º –µ–≥–æ "
                                           "–∫—É–¥–∞-–Ω–∏–±—É–¥—å, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞, –º—ã –µ–≥–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–≤–∏–¥–∏–º!\n\n"
                                           "<b>–û—Ç–ª–∏—á–Ω–æ! –ü–∞—Ä–æ–ª—å –º—ã –ø–æ–ª—É—á–∏–ª–∏, –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ</b>\n\n"
                                           "7) –ó–∞—Ö–æ–¥–∏–º –≤ –Ω–∞—à—É –ø–æ—á—Ç—É https://mail.google.com/mail –∏ —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É "
                                           "–≤–∏–¥–∏–º —à–µ—Å—Ç–µ—Ä–µ–Ω–∫—É. –ù–∞–∂–∏–º–∞–µ–º –Ω–∞ –Ω–µ–µ –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º '<i>–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</i>'\n"
                                           "8) –í –æ—Ç–∫—Ä—ã–≤—à–µ–π—Å—è –æ–∫–Ω–µ –≤—ã–±–∏—Ä–∞–µ–º –≤–∫–ª–∞–¥–∫—É '<i>–ü–µ—Ä–µ—Å—ã–ª–∫–∞ –∏ POP/IMAP</i>' (–æ–Ω–∞ "
                                           "–Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–≤–µ—Ä—Ö—É)\n"
                                           "9) –ù–∞–∂–∏–º–∞–µ–º –Ω–∞ '<i>–í–∫–ª—é—á–∏—Ç—å IMAP</i>'. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è\n"
                                           "10) –í–æ—Ç –∏ –≤—Å–µ! –£–¥–∞—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞.",)



